---
sidebar_position: 2
sidebar_label: ImportAccountEntJSON
title: Importing Accounts and Entitlements from Target Application
---


import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';


# ImportAccountEntJSON

The `ImportAccountEntJSON` is a parameter used in Saviynt's REST Connector to map attributes from a REST application to Saviynt Enterprise Identity Cloud (EIC) attributes for importing accounts and entitlements. It defines how data from the target application should be transformed and mapped into Saviynt during the import process.


## Key Elements of ImportAccountEntJSON

1. **colsToPropsMap**: This element is used to map columns from the target application's data to Saviynt attributes. It specifies how the incoming data fields should be mapped to the Saviynt schema.

2. **statusAndThresholdConfig**: This element defines configurations for handling account status and thresholds during the import process. It includes parameters for managing inactive accounts and entitlements, setting threshold values, and specifying status columns.

3. **errorHandling**: This element includes various error handling configurations to manage and respond to errors during the import process. Key fields include:
   - **expiryError**: Specifies errors related to token expiry.
   - **authError**: Lists possible authentication errors.
   - **retryFailureStatusCode**: HTTP status codes that trigger a retry mechanism.
   - **timeOutError**: Defines the behavior when a timeout occurs.
   - **errorPath**: Path to extract error messages from the response.
   - **maxRefreshTryCount**: Maximum number of retries for refreshing tokens.

### Example of ImportAccountEntJSON

Here is an example configuration for `ImportAccountEntJSON` that includes basic attribute mapping and error handling scenarios:

```json
{
  "ImportAccountEntJSON": {
    "colsToPropsMap": {
      "accountID": "id",
      "accountName": "username",
      "email": "emailAddress",
      "status": "accountStatus",
      "createdDate": "createdDate~#~epochdate"
    },
    "statusAndThresholdConfig": {
      "accountThresholdValue": 100,
      "inactivateAccountsNotInFile": true,
      "statusColumn": "accountStatus",
      "activeStatus": [
        "ACTIVE",
        "ENABLED"
      ],
      "inactivateEntsNotInFeed": true,
      "entThresholdValue": {
        "entType": {
          "Group": {
            "ent": 100
          },
          "Role": {
            "ent": 100
          }
        }
      }
    },
    "errorHandling": {
      "expiryError": [
        "token_expired",
        "session_expired"
      ],
      "authError": [
        "invalid_token",
        "authentication_failed"
      ],
      "retryFailureStatusCode": [
        401,
        403
      ],
      "timeOutError": "request_timeout",
      "errorPath": "error.message",
      "maxRefreshTryCount": 3
    }
  }
}
```

The following table describes all the attributes in ImportAccountEntJSON:

### **Attribute : accountParams** 
|  Variable        | Description                                                                                                                              |
|----------------------------|------------------------------------------------------------------------------------------------------------------------------------------|
| Connection                 | Populates the connection type value specified in the acctAuth attribute while defining ConnectionJSON.                        |
| processingType             | Always specify the processing type as.                                                                                                   |
| successResponses           | Use this variable to specify the possible response messages on successfully importing accounts.                                          |
| doNotChangeIfFailed        | Use this variable to instruct the connector to not delete or inactivate existing data on failure of the account API, the entType API, or the mapping API. When set to true, the connector does not delete or inactivate existing data. |
| call                       | Use this variable to make an API call to the target application API for importing accounts. The connector allows you to specify multiple API calls to import accounts. You must specify each API call for importing accounts as a separate call. There is no fixed name, but the preferred naming convention is: call1, call2, call3. |
| callOrder                  | Use this variable to specify the order to call APIs. Specify the value for the first call as zero. The lowest order value is called the first call. |
| stageNumber                | Use this variable to specify the stage number for the API call. Specify the stage number as zero for the first API call.                 |
| url                        | Use this variable to specify the URL of the target application.                                                                          |
| httpMethod                 | Use this variable to specify the API call method for a successful API call such as GET, POST, PUT, DELETE and GETWITHBODY.               |
| httpHeaders                | Use this variable to specify the API header parameter to send along with the API call.                                                  |
| listField                  | Use this variable to specify the path of account objects in the response JSON or XML (received after making the http API call). If the path is a nested path, separate it with a dot (.), for example, “customproperty9”: “address.home”. |
| keyField                   | Use this variable to specify the name of the field that uniquely defines whether the incoming account object is a new account or an existing account. |
| statusConfig               | Use this variable to map the status of accounts in IGA with the status in the target application.                                        |
| colsToPropsMap             | Use this variable to map account objects in the target application with account attributes in IGA, so that data from the target application is correctly saved. Review the following guidelines before mapping account attributes: |
|                            | - Represent the logical mapping in this format: <AccountsTableAttribute in EIC>::<TargetapplicationAttribute>#<Parsabledatatypeinsaviynt>  |
|                            | - Represent the target application attributes in the same case and format as they are in the target application.                         |
|                            | - If the field name in the target application contains a dot(.), use a ~dot# separator. For example, odata~dot#error.                    |
|                            | - If the list objects are at the top of the hierarchy in the response JSON, keep the field empty.                                        |
|                            | - If mapping is mandatory for a field, for example, name, accountID, mention the name of the field in the keyField variable.             |
|                            | - If the path is a nested path, separate it with a dot (.) and to specify the mapping for the path, use an index square bracket, for example, **“customproperty9”: “address.home[1].city”**. |
| Pagination                 | Use this variable to define the pagination parameters. For more information, see the Pagination feature in **ImportAccountEntJSON**.      |
| inputParams                | Set the **dependentCall** variable as , if you want to import the metadata of an account in successive calls. The value passed in the **URL** variable of an API is called for each account. The value specified in the **nextApiKeyField** variable is bound in the URL variable of the successive API calls. |
|                            | For example, if you want to get the metadata of account based on account ID, specify the value for the nextApiKeyField variable as accountID. The account ID of the account in the previous call is bound in the URL variable of the successive API calls. |
|                            | Set the dependentCall variable as false, if you do not want to mark successive calls to be dependent on the previous call.               |
| disableDeletedAccounts     | This variable is no longer required after the introduction of the **statusAndThresholdConfig** variable. Set this to false in the current codebase. |
| acctEntMappings            | Use this variable to specify the mapping between accounts and entitlements if there is no separate API call made for entitlements import. |
|                            | - Use **importAsEntitlement** to instruct the connector to import entitlements. When set to true, the connector imports associated entitlements. The default value is false. |
|                            | - Do not specify any value in listPath.                                                                                                  |
|                            | - Do not specify any value in idPath.                                                                                                    |
|                            | - Do not specify any value in keyField.                                                                                                  |
|                            | - Use colsToPropsMap to map entitlement objects in the target application with entitlement attributes in IGA, so that data from the target application is correctly saved. Specify values in this variable, only if **importAsEntitlement** is set as true. |
|                            | - You must specify the following entry in colsToPropsMap of one of the accounts calls: **"customproperty31": "STORE#ACC#ENT#MAPPINGINFO~#~char"** |
|                            | - Use statusConfig to map the status of entitlements in IGA with the status in the target application.                                   |

### **Attribute : entitlementParams**
|  Variable        | Description                                                                                                                              |
|----------------------------|------------------------------------------------------------------------------------------------------------------------------------------|
| Connection                 |  Populates the connection type value specified in the acctAuth attribute while defining **ConnectionJSON**.                    |
| processingType             | Always specify the processing type as **SequentialAndIterative**.                                                                       |
| successResponses           | Use this variable to specify the possible response messages on successfully importing entitlements.                                      |
| doNotChangeIfFailed        | Use this variable to instruct the connector to not delete or inactivate existing data on failure of the account API, the entType API, or the mapping API. When set to true, the connector does not delete or inactivate existing data. |
| entTypes                   | Use this variable to specify all entitlement types to be imported.                                                                       |
| entTypeOrder               | Each entitlement type can comprise of multiple API calls. Specify order of the entitlement type as 0 for the first entitlement type, specify as 1 for the second entitlement type, and so on. |
| entTypeLabels              | Use this variable to define the label for an EntitlementType property. For example, if you want to rename the customproperty3 to Tag specify "customproperty3": "Tags", under entTypeLabels. |
| call                       | Use this variable to make an API call to the target application API for importing entitlements. The connector allows you to specify multiple API calls to import entitlements. You must specify each API call for importing entitlements as a separate call. There is no fixed name, but the preferred naming convention is: call1, call2, call3. |
| callOrder                  | Use this variable to specify the order to call APIs. Specify the value for the first call as zero. The lowest order value is called the first call. |
| stageNumber                | Use this variable to specify the stage number for the API call. Specify the stage number as zero for the first API call.                 |
| inputParams                | Set the dependentCall variable as true, if you want to import the metadata of an entitlement in successive calls. The value passed in the URL variable of an API is called for each entitlement. The value specified in the nextApiKeyField variable is bound in the URL variable of the successive API calls. |
|                            | For example, if you want to get the metadata of entitlement based on entitlement ID, specify the value for the **nextApiKeyField** variable as entitlementID. The entitlement ID of the entitlement in the previous call is bound in the URL variable of the successive API calls. |
|                            | Set the dependentCall variable as false, if you do not want to mark successive calls to be dependent on the previous call.               |
| http                       | Use this variable to specify the http details required to make the API call, for example, URL, http params, headers, content-type, ssl parameters. For most cases, Authorization header value is ${access_token} which is a place holder and it is populated from the accessToken attribute in ConnectionJSON. Specify httpContentType as application/x-www-form-urlencoded, application/json, application/xml. |
| listField                  | Use this variable to specify the path of entitlement objects in the response JSON or XML (received after making the http API call). If the path is a nested path, separate it with a dot (.), for example, “customproperty9”: “address.home”. |
| keyField                   | Use this variable to specify the column name in IGA where the entitlement identification ID is saved.                                   |
| statusConfig               | Use this variable to map the status of entitlements in IGA with the status in the target application.                                    |
| colsToPropsMap             | Use this variable to map entitlement objects in the target application with entitlement attributes in IGA, so that data from the target application is correctly saved. Review the following guidelines before mapping entitlement attributes: |
|                            | - Represent the logical mapping in this format: <EntitlementsTableAttribute in EIC>::<TargetapplicationAttribute>#<Parsabledatatypeinsaviynt> |
|                            | - Represent the target application attributes in the same case and format as they are in the target application.                         |
|                            | - If the field name in the target application contains a dot(.), use a ~dot# separator. For example, odata~dot#error.                    |
|                            | - If the list objects are at the top of the hierarchy in the response JSON, keep the field empty.                                        |
|                            | - Instead of specifying the column name in status field under colstoprop, map the status field to a customproperty and add this value in **STATUS_THRESHOLD_CONFIG**. |
| Pagination                 | Use this variable to define the pagination parameters. For more information, see the Pagination feature in **ImportAccountEntJSON**.      |
| disableDeletedEntitlements | This variable is no longer required after the introduction of the **statusAndThresholdConfig** variable. Set this to false in the current codebase. |
| makeProcessingStatus       | Use this variable when there are multiple API calls involved for importing one entitlement type. In most cases, there is an API that gets all the entitlement objects of that type and other APIs might obtain additional data for each entitlement object. In this case, the status of the entitlement should be in process till all the details of that entitlement object is imported. Hence, makeProcessingStatus can be set to true for the first API call and false for the successive API call. The default value is false. |

### **Attribute : acctEntParams**
|  Variable        | Description                                                                                                                              |
|----------------------------|------------------------------------------------------------------------------------------------------------------------------------------|
|  createUsers             |  Use this variable to instruct the connector to create users while importing accounts. When set to true, users are created during account import. The default value is false. |
|                            | **adminName** : If createUsers is true, new users are imported and the manager is set as an admin as default. Select the user name if you want to add the user manager other than admin. |
| Connection                 | Populates the connection type value specified in the acctAuth attribute while defining **ConnectionJSON**.                              |
| statusAndThresholdConfig   | Use this variable, if you are not specifying any value in the **STATUS_THRESHOLD_CONFIG** connection parameter.                         |
| statusColumn               | Specify the account attribute mapped with the status of the account. Use this variable, if you are not specifying any value in the **statusColumn** attribute of the **STATUS_THRESHOLD_CONFIG** connection parameter. |
| processingType             | Always specify the processing type as **SequentialAndIterative**.                                                                       |
| successResponses           | Use this variable to specify the possible response messages on successfully importing entitlements.                                      |
| entTypes                   | Use this variable to specify all entitlement types to be imported.                                                                       |
| call                       | Use this variable to make an API call to the target application API for importing entitlements. The connector allows you to specify multiple API calls to import entitlements. You must specify each API call for importing entitlements as a separate call. There is no fixed name, but the preferred naming convention is: call1, call2, call3. |
| callOrder                  | Use this variable to specify the order to call APIs. Specify the value for the first call as zero. The lowest order value is called the first call. |
| stageNumber                | Use this variable to specify the stage number for the API call. Specify the stage number as zero for the first API call.                 |
| http                       | Use this variable to specify the http details required to make the API call, for example, URL, http params, headers, content-type, ssl parameters. For most cases, Authorization header value is ${access_token} which is a place holder and it is populated from the accessToken attribute in ConnectionJSON. Specify httpContentType as application/x-www-form-urlencoded, application/json, application/xml. |
| listField                  | Use this variable to specify the path of entitlement objects in the response JSON or XML (received after making the http API call). If the path is a nested path, separate it with a dot (.), for example, “customproperty9”: “address.home”. |
| acctIdPath                 | Use this variable to define the path of the account ID in the response JSON.                                                            |
| entIdPath                  | Use this variable to define the path of the entitlement ID in the response JSON.                                                       |
| ownerIdPath                | Use this variable to define the path of the owner of the entitlement in the response JSON.                                              |
| acctKeyField               | Use this variable to define the key field that uniquely identifies the account.                                                         |
| entKeyField                | Use this variable to define the key field that uniquely identifies the entitlement value.                                               |
| ownerKeyField              | Use this variable to define the key field that uniquely identifies the owner of the entitlement.                                        |

### **Attribute : entOwnerParams**
|  Variable        | Description                                                                                                                              |
|----------------------------|------------------------------------------------------------------------------------------------------------------------------------------|
| Connection                 |  Populates the connection type value specified in the acctAuth attribute while defining **ConnectionJSON**.                    |
| successResponses           | Use this variable to specify the possible response messages on successfully importing entitlement owner.                                |
| doNotChangeIfFailed        | Use this variable to instruct the connector to not delete or inactivate existing data on failure of the API. When set to true, the connector does not delete or inactivate existing data. |
| entTypes                   | Use this variable to specify all entitlement types to be imported.                                                                       |
| callOrder                  | Use this variable to specify the order to call APIs. Specify the value for the first call as zero. The lowest order value is called the first call. |
| stageNumber                | Use this variable to specify the stage number for the API call. Specify the stage number as zero for the first API call.                 |
| ownerKeyField              | Use this variable to define the key field that uniquely identifies the owner of the entitlement.                                        |
| http                       | Use this variable to specify the http details required to make the API call, for example, URL, http params, headers, content-type, ssl parameters. For most cases, Authorization header value is ${access_token} which is a place holder and it is populated from the accessToken attribute in ConnectionJSON. Specify httpContentType as application/x-www-form-urlencoded, application/json, application/xml. |
| listField                  | Use this variable to specify the path of entitlement objects in the response JSON or XML (received after making the http API call). If the path is a nested path, separate it with a dot (.), for example, “customproperty9”: “address.home”. |
| acctIdPath                 | Use this variable to define the path of the account ID in the response JSON.                                                            |
| entIdPath                  | Use this variable to define the path of the entitlement ID in the response JSON.                                                       |
| ownerIdPath                | Use this variable to define the path of the owner of the entitlement in the response JSON.                                              |
| acctKeyField               | Use this variable to define the key field that uniquely identifies the account.                                                         |
| entKeyField                | Use this variable to define the key field that uniquely identifies the entitlement value.                                               |

### **Attribute : entMappingParams**
|  Variable        | Description                                                                                                                              |
|----------------------------|------------------------------------------------------------------------------------------------------------------------------------------|
| Connection                 |  Populates the connection type value specified in the acctAuth attribute while defining **ConnectionJSON**.                    |
| callOrder                  | Use this variable to specify the order to call APIs. Specify the value for the first call as zero. The lowest order value is called the first call. |
| stageNumber                | Use this variable to specify the stage number for the API call. Specify the stage number as zero for the first API call.                 |
| http                       | Use this variable to specify the http details required to make the API call, for example, URL, http params, headers, content-type, ssl parameters. For most cases, Authorization header value is ${access_token} which is a place holder and it is populated from the accessToken attribute in ConnectionJSON. Specify httpContentType as application/x-www-form-urlencoded, application/json, application/xml. |
| listField                  | Use this variable to specify the path of entitlement objects in the response JSON or XML (received after making the http API call). If the path is a nested path, separate it with a dot (.), for example, “customproperty9”: “address.home”. |
| ent1IdPath                 | Use this variable to define the path of the parent entitlement ID in the response JSON.                                                 |
| ent2IdPath                 | Use this variable to define the path of the child entitlement ID in the response JSON.                                                  |
| ent1KeyField               | Use this variable to define the key field that uniquely identifies the entitlement value of the parent entitlement.                     |
| ent2KeyField               | Use this variable to define the key field that uniquely identifies the entitlement value of the child entitlement.                      |
| targetEntType              | Use this variable to reference the name of child entitlement type for mapping.                                                         |
| mappingTypes               | Use this variable to define the type of mapping to be used. The possible values are:                                                    |
|                            | - ENTMAP - enables bi-directional mapping through entitlementmap.                                                                      |
|                            | - ENT2 - makes the target entitlement type as a child of current entitlement.                                                           |



### Sample ConnectionJSON

#### Sample 1
This **ConnectionJSON** is a comprehensive setup for authenticating via OAuth2 using username and password as credentials. It covers various error handling scenarios, specifies how to process and interpret API responses, and includes robust retry logic to handle token expiration effectively. This configuration is essential for maintaining secure and efficient access to APIs requiring OAuth2 authentication.


<details>
<summary> JSON </summary>
<p>
``` json
{
  "authentications": {
    "userAuth": {
      "authType": "oauth2",
      "url": "https://<domain name>/api/v18.2/auth",
      "httpMethod": "POST",
      "httpParams": {
        "username": "<Username>",
        "password": "<Password>"
      },
      "httpHeaders": {
        "contentType": "application/x-www-form-urlencoded"
      },
      "httpContentType": "application/x-www-form-urlencoded",
      "expiryError": "ExpiredAuthenticationToken",
      "authError": [
        "InvalidAuthenticationToken",
        "AuthenticationFailed",
        "FAILURE",
        "INVALID_SESSION_ID"
      ],
      "timeOutError": "Read timed out",
      "errorPath": "errors.type",
      "maxRefreshTryCount": 5,
      "tokenResponsePath": "sessionId",
      "tokenType": "Bearer",
      "accessToken": "<access token>"
    }
  }
}
```
</p>
</details>
**Authentication Configuration Details**

- **Authentication Type (`authType`)**: `oauth2`
  - Specifies that the OAuth 2.0 protocol is used for authentication. This is a common standard for authorizing secure API requests by obtaining an access token.

- **URL (`url`)**: `https://<domain name>/api/v18.2/auth`
  - This is the endpoint where the OAuth2 authentication request is sent. The `<domain name>` should be replaced with the actual domain of the API providing the OAuth2 service.

- **HTTP Method (`httpMethod`)**: `POST`
  - The method used to send the request to the authentication URL. OAuth2 typically uses POST to securely transmit credential data.

- **HTTP Parameters (`httpParams`)**:
  - `username`: `<Username>`
  - `password`: `<Password>`
  - These fields hold the credentials needed to authenticate the request. `<Username>` and `<Password>` are placeholders and should be replaced with actual user credentials.

- **HTTP Headers (`httpHeaders`)**:
  - `contentType`: "application/x-www-form-urlencoded"
  - Specifies the media type of the request body, indicating that the form data is URL-encoded.

- **HTTP Content Type (`httpContentType`)**: `application/x-www-form-urlencoded`
  - Reiterates the content type specified in the headers, ensuring the body format is recognized by the server handling the authentication.

- **Expiry Error (`expiryError`)**: `ExpiredAuthenticationToken`
  - Defines the error message or code that is expected when the authentication token has expired, prompting re-authentication or token refresh.

- **Authentication Error (`authError`)**:
  - `InvalidAuthenticationToken`
  - `AuthenticationFailed`
  - `FAILURE`
  - `INVALID_SESSION_ID`
  - This array lists possible error messages or codes that can be encountered if authentication fails for various reasons, such as invalid credentials or session timeouts.

- **Time Out Error (`timeOutError`)**: `Read timed out`
  - Specifies the error message when the authentication request times out due to server non-responsiveness or network issues.

- **Error Path (`errorPath`)**: `errors.type`
  - This is the JSON path that points to where in the response body the error details are provided when an authentication error occurs.

- **Max Refresh Try Count (`maxRefreshTryCount`)**: 5
  - Indicates the maximum number of times the system should attempt to refresh the authentication token before giving up and reporting a failure.

- **Token Response Path (`tokenResponsePath`)**: `sessionId`
  - The JSON path where the access token (or session ID in this context) can be found in the API response.

- **Token Type (`tokenType`)**: `Bearer`
  - Declares the type of token being used, which in this case is a Bearer token. This indicates that the token should be included in the Authorization header of subsequent API requests.

- **Access Token (`accessToken`)**: `<access token>`
  - This is a placeholder for the initial access token, which might be pre-provided for initial setup or testing. It should be replaced with an actual token once obtained.


#### Sample 2
This sample ConnectionJSON describes when the access token is available as part of response headers

This `ConnectionJSON` outlines an OAuth2 authentication configuration but requires several details to be fully operational. It is crucial to fill in the empty fields with accurate data according to the specific API requirements and security practices. This configuration is essential for maintaining secure access to APIs that require OAuth2 authentication.

JSON

```
{
  "authentications": {
    "acctAuth": {
      "authType": "oauth2",
      "url": "",
      "httpMethod": "POST",
      "httpParams": {
      },
      "httpHeaders": {
        "Content-Type": "application/x-www-form-urlencoded"
      },
      "httpContentType": "application/x-www-form-urlencoded",
      "expiryError": "ExpiredAuthenticationToken",
      "authError": [
        "USER_AUTHENTICATION_FAILED"
      ],
      "timeOutError": "error",
      "errorPath": "error",
      "maxRefreshTryCount": 3,
      "tokenResponsePath": "#HEADERS#Set-Cookie",
      "tokenType": "",
      "authHeaderName": "Cookie",
      "retryFailureStatusCode": [
      ],
      "accessToken": "sdfghjk"
    }
  }
}
```

> Note
> #HEADERS# is mandatory, if access token is present in the response headers.

**Authentication Configuration Details**

- **Authentication Type (`authType`)**: `oauth2`
  - **Description**: Specifies that OAuth 2.0 protocol is used for authentication. This protocol is primarily used for securing API requests by validating credentials and issuing tokens.

- **URL (`url`)**:
  - **Description**: The endpoint URL where the OAuth2 authentication request is sent. Currently, this is empty and needs to be specified with the actual API endpoint.

- **HTTP Method (`httpMethod`)**: `POST`
  - **Description**: The method used to send the request to the authentication URL. POST is typically used to securely transmit credential data to the server.

- **HTTP Parameters (`httpParams`)**:
  - **Description**: This should include any necessary parameters required for the authentication request. Currently, this object is empty and should be configured based on specific OAuth2 requirements.

- **HTTP Headers (`httpHeaders`)**:
  - **Content-Type**: "application/x-www-form-urlencoded"
    - **Description**: Specifies the media type of the request body, indicating that the form data is URL-encoded.

- **HTTP Content Type (`httpContentType`)**: `application/x-www-form-urlencoded`
  - **Description**: Reinforces that the body of the HTTP request is URL-encoded.

- **Expiry Error (`expiryError`)**: "ExpiredAuthenticationToken"
  - **Description**: Defines the error message that is expected when the authentication token has expired, prompting a token refresh or re-authentication.

- **Authentication Error (`authError`)**:
  - **List**:
    - "USER_AUTHENTICATION_FAILED"
  - **Description**: Specifies the error messages that can be encountered if the authentication process fails. This helps in diagnosing authentication issues.

- **Time Out Error (`timeOutError`)**: "error"
  - **Description**: Specifies the error message when the authentication request times out. This needs more specific detailing to reflect actual timeout errors.

- **Error Path (`errorPath`)**: "error"
  - **Description**: This is the JSON path that points to where in the response body the error details are provided when an authentication error occurs.

- **Maximum Refresh Try Count (`maxRefreshTryCount`)**: 3
  - **Description**: Indicates the maximum number of attempts the system should make to refresh the authentication token before giving up and returning an error.

- **Token Response Path (`tokenResponsePath`)**: "#HEADERS#Set-Cookie"
  - **Description**: Specifies where in the API response the authentication token can be found. In this case, it's indicated that the token is stored in the response headers under 'Set-Cookie'.

- **Token Type (`tokenType`)**:
  - **Description**: This should specify the type of token (e.g., Bearer, Basic). Currently, it is empty and needs to be defined based on the OAuth2 setup.

- **Authentication Header Name (`authHeaderName`)**: "Cookie"
  - **Description**: Specifies the HTTP header name where the token is expected. It is set to "Cookie", which might be used for cookie-based session management.

- **Retry Failure Status Code (`retryFailureStatusCode`)**:
  - **Description**: An array that should list the HTTP status codes that, when encountered, should trigger a retry of the API call. It is currently empty and should include status codes like 401 or 503 based on the API's error handling practices.

- **Access Token (`accessToken`)**: "sdfghjk"
  - **Description**: This is a placeholder for the initial access token, which might be provided for setup or testing. This should be replaced with an actual token obtained through the authentication process.


### Common Features

#### Multiple Authentications 
Supports multiple authentications where more than one authentication mechanism is required. For example, for Azure AD, there are graph.windows.net APIs and [http://graph.microsoft.com](http://graph.microsoft.com) APIs and each API has a different authentication mechanism and hence two authentication constructs are used in ConnectionJSON.

Example:

``` JSON
{
  "authentications": {
    "userAuth": {
      "authType": "oauth2",
      "url": "https://<domain name>/<<TenantID>>/oauth2/token",
      "httpMethod": "POST",
      "httpParams": {
        "grant_type": "client_credentials",
        "client_secret": "<<ClientSecret>>",
        "client_id": "<<ClientID>>",
        "resource": "https://graph.microsoft.com/"
      },
      "httpHeaders": {
        "contentType": "application/x-www-form-urlencoded"
      },
      "httpContentType": "application/x-www-form-urlencoded",
      "expiryError": "ExpiredAuthenticationToken",
      "authError": [
        "InvalidAuthenticationToken"
      ],
      "timeOutError": "Read timed out",
      "errorPath": "error.code",
      "maxRefreshTryCount": 5,
      "tokenResponsePath": "access_token",
      "tokenType": "Bearer",
      "accessToken": "Bearer abc"
    },
    "entAuth": {
      "authType": "oauth2",
      "url": "https://<domain name>/<<TenantID>>/oauth2/token",
      "httpMethod": "POST",
      "httpParams": {
        "grant_type": "client_credentials",
        "client_secret": "<<ClientSecret>>",
        "client_id": "<<ClientID>>",
        "resource": "https://graph.windows.net/"
      },
      "httpHeaders": {
        "contentType": "application/x-www-form-urlencoded"
      },
      "httpContentType": "application/x-www-form-urlencoded",
      "expiryError": "ExpiredAuthenticationToken",
      "authError": [
        "InvalidAuthenticationToken",
        "Authentication_MissingOrMalformed"
      ],
      "timeOutError": "Read timed out",
      "errorPath": "odata~dot#error.code",
      "maxRefreshTryCount": 3,
      "tokenResponsePath": "access_token",
      "tokenType": "Bearer",
      "accessToken": "Bearer abcde"
    }
  }
}
```
#### SSL Parameter
Installing SSL certificates is sufficient to make https API calls, however, if target applications expect customizations such as the TLS version, you can pass SSL parameters while making API calls.

``` JSON
{
  "authentications": {
    "acctAuth": {
      "authType": "oauth2",
      "url": "XXXXXXXXXXXX",
      "httpMethod": "POST",
      "httpParams": {
        "grant_type": "client_cert"
      },
      "httpContentType": "application/x-www-form-urlencoded",
      "ssl": {
        "keyFile": "opt/java/jdk1.8.0_181/jre/lib/security/cacerts",
        "keyFilePassword": "changeit",
        "keyManagerAlgorithm": "SunX509",
        "keyStoreType": "JKS",
        "sslAlgorithmName": "TLSv1.2"
      },
      "httpHeaders": {
        "Content-Type": "application/x-www-form-urlencoded",
        "Authorization": "Basic xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
      },
      "retryFailureStatusCode": [401],
      "expiryError": "ExpiredAuthenticationToken",
      "authError": [
        "SESSION_NOT_VALID",
        "AuthenticationFailed",
        "ExpiredJwtException",
        "401 Unauthorized"
      ],
      "timeOutError": "Read timed out",
      "errorPath": "code",
      "maxRefreshTryCount": 6,
      "tokenResponsePath": "access_token",
      "tokenType": "Bearer",
      "accessToken": "Bearer xxxxxxxxxxxxxxxxx"
    }
  }
}
```
#### Connection JSON Validation 
The connector supports validating authType as oauth2. To do this, populate the http parameters in the **testConnectionParams** attribute. It validates the connection parameters and prompts Successful or Failed status based on the provided credentials while saving the connection.

From Release v23.10 onwards, if you specify an incorrect value or blank value for the testConnectionParams attribute in the ConnectionJSON parameter and then click Save & Test Connection, the connector displays a detailed error message in the debug log file and the Job Log Detail page of the Test Connections Job. The message includes the name of the failed connection, type of error with exception that occurred in the target, and any additional details that might help in troubleshooting the connection issue.

For more information about troubleshooting issues encountered during saving and testing a connection, see Errors while Saving and Testing a Connection under Troubleshooting Issues in the REST Integration Guide.


Example:

JSON

```
{
  "authentications": {
    "acctAuth": {
      "authType": "Basic",
      "url": "https://<domain name>",
      "httpMethod": "POST",
      "httpParams": {},
      "httpHeaders": {},
      "httpContentType": "text/html",
      "properties": {
        "userName": "username",
        "password": "password"
      },
      "expiryError": "Couldn't authenticate you",
      "authError": [
        "Couldn't authenticate you"
      ],
      "timeOutError": "Read timed out",
      "errorPath": "error",
      "maxRefreshTryCount": 5,
      "tokenResponsePath": "access_token",
      "tokenType": "Basic",
      "accessToken": "Basic asdfghjkl",
      "testConnectionParams": {
        "http": {
          "url": "https://<domain name>/api/v2/users.json",
          "httpHeaders": {
            "Authorization": "${access_token}"
          },
          "httpContentType": "application/json",
          "httpMethod": "GET"
        },
        "successResponse": [],
        "successResponsePath": "",
        "errors": [
          "Couldn't authenticate you"
        ],
        "errorPath": "error"
      }
    }
  }
  }
```
### Authentication Types
The following authentication types are supported:
#### Basic 
Used for authentication where only username and password are required to authorize the REST API calls. Values for username or password fields must be provided in the properties attribute. You can leave the HTTP related parameters empty.

Example:

JSON
```
{
  "authentications": {
    "acctAuth": {
      "authType": "Basic",
      "url": "<URL>",
      "httpMethod": "POST",
      "httpParams": {},
      "httpHeaders": {},
      "httpContentType": "text/html",
      "properties": {
        "userName":"<<USERNAME>>",
        "password":"<<PASSWORD>>"
      },
      "expiryError": "ExpiredAuthenticationToken",
      "authError": [
        "InvalidAuthenticationToken",
        "AuthenticationFailed"
      ],
      "timeOutError": "Read timed out",
      "testname": "<test URL>",
      "errorPath": "error.code",
      "maxRefreshTryCount": 5,
      "tokenResponsePath": "access_token",
      "tokenType": "Basic",
      "accessToken": "Basic <<TOKEN>>",
"apiRateLimitConfig": {"retryAfterCalls": 100,"retryWaitSeconds": 60}
    }
  }
}
```

#### BasicWithAccessToken
Used for authentication when the access token is obtained using the basic username and password credentials. In this type, the primary http parameters are **url** , **httpHeaders** , **httpMethod** and **httpContentType**.


> Note
> The refresh token for applications such as Hydra expires once it is used or the time-period is elapsed. The refreshTokenFlag is added to refresh the token based on your selection such as set it to 'true' refreshes the refresh token immediately after generating new access token for subsequent use. The refresh token calls the refresh token API right after the access token generation.

Example 1:

```
{
  "authentications": {
    "acctAuth": {
      "authType": "BasicWithAccessToken",
      "url": "{url}}",
      "httpMethod": "POST",
      "httpHeaders": {"Accept": "application/json"},
      "properties": {"userName": "<username>","password": "<password>"},
      "httpContentType": "application/json",
      "expiryError": "ExpiredAuthenticationToken",
      "retryFailureStatusCode": [403,401,500],
      "authError": [
        "InvalidAuthenticationToken",
        "AuthenticationFailed",
        "Authentication_MissingOrMalformed",
        "Authentication_ExpiredToken"
      ],
      "timeOutError": "Read timed out",
      "errorPath": "error.code",
      "maxRefreshTryCount": 5,
      "tokenResponsePath": "access_token",
      "tokenType": "Bearer",
      "accessToken": "Bearer xyz"
    }
  }
}
```
Example 2: To refresh the token for BasicwithAccesToken auth type when the import job fails with 417 error code, use a format similar to the following:

```
{
  "authentications": {
    "user": {
      "authType": "BasicWithAccessToken",
      "url": "<URL>",
      "httpMethod": "POST",
      "httpHeaders": {
        "Accept": "application/json"
      },
      "httpParams": {
        "UserId": "<user ID>",
        "Password": "<password>",
        "Server": "<Server name>"
      },
      "properties": {
        "userName": "<user name>",
        "password": "<password>"
      },
      "httpContentType": "application/json",
      "expiryError": "ExpiredAuthenticationToken",
      "retryFailureStatusCode": [403,401,417,],
      "authError": [
        "InvalidAuthenticationToken",
        "AuthenticationFailed",
        "Authentication_MissingOrMalformed",
        "Authentication_ExpiredToken"
      ],
      "timeOutError": "Read timed out",
      "errorPath": "error.code",
      "maxRefreshTryCount": 5,
      "tokenResponsePath": "token",
      "tokenType": "",
      "accessToken": "Bearer xyz"
    }
  }
}
```

#### BasicWithHMAC
Used when authentication requires Hash-based Message Authentication Code (HMAC) signed signature using the credentials passed in the **properties**

Example:
```
{
  "authentications": {
    "acctAuth": {
      "authType": "BasicWithHmac",
      "url": "<url>",
      "httpMethod": "POST",
      "properties": {
        "IKEY": "<<IKEY>>",
        "SKEY": "<<SKEY>>"
      },
      "authError": [
        "InvalidAuthenticationToken",
        "AuthenticationFailed",
        "Authentication_MissingOrMalformed",
        "Authentication_ExpiredToken"
     ],
      "errorPath": "error.code",
      "maxRefreshTryCount": 5,
      "tokenResponsePath": "access_token",
      "tokenType": "Basic",
      "accessToken": "Basic xyz"
    }
  }
}
```

#### Cookies
Used for authentication using cookies.

Example 
```
{
  "authentications": {
    "acctAuth": {
      "authType": "cookies",
      "url": "",
      "httpMethod": "POST",
      "httpParams": {
        "username": "<specify username>",
        "password": "<specify password>",
        "apiKey": "${apiKey}",
        "timestamp": "${timestamp}"
      },
      "httpHeaders": {
        "contentType": "application/json"
      },
      "cookies": "${cookies}",
      "properties": {
        "apiKey": "${apiKey}"
      },
      "httpContentType": "application/json",
      "expiryError": "ExpiredAuthenticationToken",
      "authError": [
        "SESSION_NOT_VALID",
        "AuthenticationFailed",
        "HTTP error code : 401"
      ],
      "timeOutError": "Read timed out",
      "errorPath": "code",
      "maxRefreshTryCount": 5,
      "tokenResponsePath": "",
      "tokenType": "",
      "accessToken": "<specify access token>",
      "retryFailureStatusCode": [
        500,
        502,
        401
      ]
    }
  }
}
```

#### SignedHeaders
Used for authentication using SignedHeaders.

Example  JSON
```
{
  "authentications": {
    "acctAuth": {
      "authType": "SignedHeaders",
      "httpMethod": "POST",
      "httpHeaders": {
        "contentType": "application/x-www-form-urlencoded"
      },
      "httpContentType": "application /x-www-form-urlencoded",
      "properties": {
        "userId": "pivotal",
        "keyFilePath": "<specify key file path>"
      },
      "expiryError": "ExpiredAuthenticationToken",
      "authError": [
        "InvalidAuthenticationToken",
        "AuthenticationFailed"
      ],
      "timeOutError": "Read timed out",
      "errorPath": "message",
      "maxRefreshTryCount": 5,
      "tokenResponsePath": "access_token",
      "tokenType": "Bearer",
      "accessToken": "<specify access token>"
    }
  }
}
```
#### JWT 
Used for authentication using JSON Web Tokens (JWT). For this authentication, specify the values for the following attributes: **httpParamsName** , **jwtConfig** , **signedAlgorithm** , **key** , and **jwtExpiryDuration**.


To specify **httpParamsName** as assertion, use the following format:

Example JSON

```
{
  "authentications": {
    "acctAuth": {
      "authType": "Jwt",
      "httpParamsName": "assertion",
"jwtConfig": {
        "jwtHeader": {
          "alg": "<specify algorithm>",
          "typ": "JWT",
          "kid": "<specify key ID>"
        },
        "jwtPayload": {
          "iss": "<specify ISS>",
          "sub": "<specify subject>",
          "aud": "<specify audience>",
          "scope": "https://www.googleapis.com/auth/admin.directory.user https://www.googleapis.com/auth/admin.directory.group https://www.googleapis.com/auth/admin.directory.domain"
        },
        "signedAlgorithm": "<specify signed algorithm>",
        "key": "<specify key>",
        "jwtExpiryDuration": 120
      },
      "url": "<specify URL>",
      "httpMethod": "POST",
      "httpParams": {
        "grant_type": "urn:ietf:params:oauth:grant-type:jwt-bearer"
      },
      "httpContentType": "application/x-www-form-urlencoded",
      "retryFailureStatusCode": [
        401,
        500,
        400
      ],
      "authError": [
        "SESSION_NOT_VALID",
        "AuthenticationFailed",
        "ExpiredJwtException",
        "401 Unauthorized",
        "401",
        "You couldn't be authenticated"
      ],
      "errorPath": "code",
      "maxRefreshTryCount": 5,
      "tokenResponsePath": "access_token",
      "tokenType": "Bearer",
      "accessToken": ""
    }
  }
}
```
To specify **httpParamsName** as jwt_token, use the following format:

Example JSON
```
{
  "authentications": {
    "acctAuth": {
      "authType": "Jwt",
      "httpParamsName": "jwt_token",
"jwtConfig": {
        "jwtHeader": {
          "alg": "<specify algorithm>",
          "typ": "JWT"
        },
        "jwtPayload": {
          "exp": 1675754298,
          "iss": "<specify ISS>",
          "sub": "<specify subject>",
          "aud": "<specify audience>"
        },
        "signedAlgorithm": "<specify signed algorithm>",
        "key": "<specify key>",
        "jwtExpiryDuration": 120
      },
      "url": "<specify URL>",
      "httpMethod": "POST",
      "httpParams": {
        "client_id": "<client_id>",
        "client_secret": "<client_secret>"
      },
      "httpContentType": "multipart/form-data",
      "retryFailureStatusCode": [
        401,
        500,
        400
      ],
      "authError": [
        "SESSION_NOT_VALID",
        "AuthenticationFailed",
        "ExpiredJwtException",
        "401 Unauthorized",
        "401",
        "You couldn't be authenticated"
      ],
      "errorPath": "code",
      "maxRefreshTryCount": 5,
      "tokenResponsePath": "access_token",
      "tokenType": "Bearer",
      "accessToken": "Bearer abcd"
    }
  }
}
```
#### OAuth2
Supports OAuth protocol for API authorization with various types of OAuth2 mechanisms. You must provide the token that the connector must regenerate when a wrong token is specified or existing token has expired.


> To regenerate the token, provide the values for the following attributes: url , httpMethod , httpParams , httpHeaders , and httpContentType.

The following tokens are used for OAuth:

##### Static Access Token
Some cloud applications support hardcoded access token that never expires until it is manually revoked from the target application. In this case, an attribute named **accessToken** is populated with the hardcoded token and other parameters are left with dummy values.

Example JSON
  ```
       {
         "authentications": {
           "userAuth": {
             "authType": "oauth2",
             "url": "<URL>",
             "httpMethod": "POST",
             "httpParams": {},
             "httpHeaders": {
               "contentType": "application/x-www-form-urlencoded"
             },
             "httpContentType": "application/x-www-form-urlencoded",
             "expiryError": "ExpiredAuthenticationToken",
             "authError": [
               "InvalidAuthenticationToken",
               "AuthenticationFailed",
               "FAILURE",
               "INVALID_SESSION_ID"
             ],
        "timeOutError": "Read timed out",
        "errorPath": "errors.type",
        "maxRefreshTryCount": 5,
        "tokenResponsePath": "sessionId",
        "tokenType": "Bearer",
        "accessToken": "Bearer <token>"
          }
        }
      }
  ```
##### Static Refresh Token
In this scenario, access tokens expire after a specific time period but refresh tokens never expire. Therefore, refresh tokens are used as new access tokens. To regenerate a refresh token, specify values for the following attributes: **url** , **httpMethod** , **httpParams** , **httpHeaders** , and **httpContentType**.

Example:
``` json
{
  "authentications": {
    "acctAuth": {
      "authType": "oauth2",
      "url": "https://<domain name>/oauth/v2/token",
      "httpMethod": "POST",
      "httpParams": {
        "grant_type": "refresh_token",
        "client_id": "",
        "client_secret": "",
        "redirect_uri": "",
        "refresh_token": "<refresh token>"
      },
      "expiryError": "ExpiredAuthenticationToken",
      "retryFailureStatusCode": [401],
      "timeOutError": "Read timed out",
      "errorPath": "error",
      "maxRefreshTryCount": 3,
      "tokenResponsePath": "access_token",
      "tokenType": "Bearer",
      "accessToken": "Bearer abcd"
    }
  }
}
```

##### Renew Access Token and Refresh Token using Single API
In this OAuth mechanism, the access and refresh tokens expire after a time period, and the latest refresh token is used to regenerate new access and refresh tokens. To regenerate these tokens, specify the values for the following attributes: **refreshType** , **refreshTokenResponsePath** , and **refreshToken**.

Example:
   ``` JSON
  {
    "authentications": {
      "userAuth": {
        "authType": "oauth2",
        "url": "https://<domain name>/v1/access_token",
        "httpMethod": "POST",
        "httpParams": {
          "client_id": "<client ID>",
          "client_secret": "<client secret>",
          "grant_type": "refresh_token",
          "refresh_token": "${refresh_token}"
        },
        "httpHeaders": {
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "httpContentType": "application/x-www-form-urlencoded",
        "expiryError": "ExpiredAuthenticationToken",
        "authError": [
          "USER_AUTHENTICATION_FAILED",
          "PARTNER_AUTHENTICATION_FAILED",
          "AuthenticationFailed"
        ],
        "refreshType": "RefreshToken",
        "refreshTokenResponsePath": "refresh_token",
        "refreshToken": "<refresh token>",
        "timeOutError": "Read timed out",
        "errorPath": "errorCode",
        "maxRefreshTryCount": 5,
        "tokenResponsePath": "access_token",
        "tokenType": "Bearer",
        "retryFailureStatusCode": [401],
        "accessToken": "Bearer <token>"
      }
    }
  }
   ```

##### Renew Access Token and Refresh Token using Different API
In some OAuth mechanisms, access token and refresh token both expire after a certain time period. After the refresh token is renewed, you need to place a call to obtain the new refresh token to use it for obtaining the new access token. To regenerate a token, specify the values for the following attributes: **refreshType** , **refreshTokenResponsePath** , **refreshToken** , **refrshTokenAuthError** , **refreshTokenErrorPath** , and **refreshTokenCall**.

Example:
``` JSON
  {
    "authentications": {
      "userAuth": {
        "authType": "oauth2",
        "url": "https://<domain name>/oauth/token",
        "httpMethod": "POST",
        "httpParams": {
          "company_id": "<company_id>",
          "client_id": "<client_id>",
          "grant_type": "<grant_type>",
          "assertion": "${refresh_token}"
        },
        "httpHeaders": {
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "httpContentType": "application/x-www-form-urlencoded",
        "authError": [
          "Unable to authenticate the client",
          "Invalid OAuth token Bearer"
        ],
        "retryFailureStatusCode": [401],
        "errorPath": "",
        "maxRefreshTryCount": 5,
        "tokenResponsePath": "access_token",
        "refreshType": "RefreshToken",
        "tokenType": "Bearer",
        "accessToken": "Bearer asdsdfghjk",
        "refreshToken": "<refreshToken>",
        "refreshTokenAuthError": [
          "Unable to retrieve SAML assertion",
          "The provided SAML assertion is expired"
        ],
        "refreshTokenErrorPath": "errorMessage",
        "refreshTokenCall": {
          "refreshTokenResponsePath": "",
          "url": "https://<domain name>/oauth",
          "httpMethod": "POST",
          "httpParams": {
            "client_id": "<client_id>",
            "user_id": "<user_id>",
            "token_url": "https://<domain name>/oauth/token",
            "private_key": "<private_key>"
          },
          "httpHeaders": {
            "Content-Type": "application/x-www-form-urlencoded"
          },
          "httpContentType": "application/x-www-form-urlencoded"
        }
      }
    }
  }
```
###  Mask values of sensitive attributes in logs

The connector supports masking values of sensitive attributes in logs using the **mask** **InLogs** attribute.

Example:

``` JSON
{
  "authentications": {
    "acctAuth": {
      "authType": "Basic",
      "url": "<URL>",
      "httpMethod": "POST",
      "httpParams": {},
      "httpHeaders": {},
      "httpContentType": "text/html",
      "properties": {
        "userName": "<<USERNAME>>/token",
        "password": "<<PASSWORD>>"
      },
      "expiryError": "ExpiredAuthenticationToken",
      "authError": [
        "InvalidAuthenticationToken",
        "AuthenticationFailed"
      ],
      "timeOutError": "Read timed out",
      "testname": "<test URL>",
      "maskInLogs": [
        "password",
        "username",
        "access_token",
        "refresh_token"
      ],
      "errorPath": "error.code",
      "maxRefreshTryCount": 5,
      "tokenResponsePath": "access_token",
      "tokenType": "Basic",
      "accessToken": "Basic <<TOKEN>>",
      "apiRateLimitConfig": {
        "retryAfterCalls": 100,
        "retryWaitSeconds": 60
      }
    }
  }
}

```
### Clear special characters 
> The connector supports clearing special characters in API response using the **cleanUpTextContent** attribute.


Example:

```  JSON
{
  "authentications": {
    "accAuth": {
      "authType": "oauth2",
      "url": "<url>",
      "httpMethod": "POST",
      "httpParams": {
        "organization": "<specify organization>",
        "username": "aabcd",
        "password": "12345",
        "culture": "en-US"
      },
      "httpHeaders": {
        "Accept": "application/json"
      },
      "httpContentType": "application/x-www-form-urlencoded",
      "retryFailureStatusCode": [
        401
      ],
      "errorPath": "",
      "maxRefreshTryCount": 3,
      "cleanUpTextContent": true,
      "tokenResponsePath": "token",
      "tokenType": "",
      "accessToken": "<specify access token>"
    }
  }
}

```
### Handle space in httpParams 
The connector replaces space in the **httpParams** attribute with %20 before sending the request to hit the connection API. From Release v23.5 onwards, a new content type named as application/x-www-form-urlencoded-pws is introduced.

Example:

``` JSON
{
  "authentications": {
    "userAuth": {
      "authType": "oauth2",
      "url": "<URL>",
      "httpMethod": "POST",
      "httpParams": {
        "grant_type": "password",
        "scope": "<scope>",
        "client_secret": "<client secret>",
        "username": "<user name>",
        "client_ID": "<client ID>",
        "password": "<password>"
      },
      "httpContentType": "application/x-www-form-urlencoded-pws",
      "expiryError": "ExpiredAuthenticationToken",
      "authError": [
        "USER_AUTHENTICATION_FAILED",
        "PARTNER_AUTHENTICATION_FAILED",
        "AuthenticationFailed"
      ],
      "timeOutError": "Read timed out",
      "errorPath": "errorCode",
      "maxRefreshTryCount": 5,
      "tokenResponsePath": "access_token",
      "tokenType": "Bearer",
      "retryFailureStatusCode": [401],
      "accessToken": "Bearer abc"
    }
  }
}
```
